<!DOCTYPE html>
<html lang="en"
<head>
<meta charset="utf-8" />
<script type="text/javascript" src="markovflags.js"> </script>
<script type="text/javascript">

function updateFlag() {
    var heightRatio = 0.9;
    var aspectRatio = document.getElementById("aspectRatioId").value;
    var stripeCorners = document.getElementById("stripeWidthCsvId").value.split(",");

    var canvasEle = document.getElementById("flag")
    var ctx = canvasEle.getContext("2d");
    ctx.clearRect(0, 0, canvasEle.width, canvasEle.height);

    // make clip path
    var swallowtailPointVerticals = document.getElementById("swallowtailPointVerticalsId").value.split(",");
    if (swallowtailPointVerticals[0] === "") {
        swallowtailPointVerticals = stripeCorners;
        document.getElementById("swallowtailPointVerticalsId").value = stripeCorners;
    }
    var outsidePoints = getClipPath(heightRatio, aspectRatio, swallowtailPointVerticals);

    // draw stripes
    var stripeMode = "horizontal";
    var stripeColors = document.getElementById("stripeColorCsvId").value.split(",");
    var stripeOrient = document.getElementById("stripeOrientId").value;
    if (stripeOrient == "vert") {
        drawVerticalStripes(heightRatio, aspectRatio, stripeColors, stripeCorners);
    } else if (stripeOrient == "diag") {
        drawDiagonalStripes(heightRatio, aspectRatio, stripeColors, stripeCorners);
    } else {
        drawHorizontalStripes(heightRatio, aspectRatio, stripeColors, stripeCorners);
    }

    // draw canton
    var cantonMode = document.getElementById("cantonModeId").value;
    var cantonColor = document.getElementById("cantonColorId").value;
    if (cantonMode != "none") {
        drawCanton(heightRatio, aspectRatio, cantonMode, cantonColor);
    }

    // draw outline
    drawPolygon(outsidePoints, "1", "black", null);
}

function getClipPath(heightRatio, aspectRatio, swallowtailPointVerticals) {
    var swallowtailPointStart = document.getElementById("swallowtailPointStartId").value;
    var swallowtailCutDepth = document.getElementById("swallowtailCutDepthId").value;
    var tailControl = document.getElementById("tailControlId").value.split(",");
    if (tailControl.length == 1 && tailControl[0] == "") {
        if (stripeCorners.length == 1) {
            tailControl = ["o"];
        } else {
            tailControl = []
            for (var i = 0; i < stripeCorners.length; i++) {
                tailControl.push("o");
            }
        }
    }
    if (swallowtailPointVerticals.length != tailControl.length) {
        tailControl = []
        for (var i = 0; i < stripeCorners.length; i++) {
            tailControl.push("o");
        }
    }
    document.getElementById("tailControlId").value = tailControl;
    return drawRectangularFlagOutline(heightRatio, aspectRatio,
        swallowtailPointStart, swallowtailCutDepth, swallowtailPointVerticals, tailControl);
}
</script>
<style type="text/css">
    canvas {
        border: solid red 1px;
    }
</style>
</head>
<body onload="updateFlag();">
<h1>Generate A Flag</h1>
Being inspired from the flag generator on
<a href="http://www.learnedleague.com/">Learned League</a>, and
<a href="http://politiscales.la-commune.net/en_US/quiz/">PolitiScacles</a>,
I decided to make my own.
<canvas id="flag" height="500" width="1000">
  Your browser needs to support canvas for this to work!
</canvas>
<form id="debugForm">
    <fieldset>
        <legend>Shape</legend>
        <label for="aspectRatio">aspect ratio</label>
        <input type="text" name="aspectRatio" id="aspectRatioId" value="2.0" />
        <br/>

        <label for="swallowtailPointStart">swallowtail start ratio</label>
        <input type="text" name="swallowtailPointStart" id="swallowtailPointStartId" value="0.5" />
        <br/>

        <label for="swallowtailCutDepth">swallowtail cut depth ratio</label>
        <input text="text" name="swallowtailCutDepth" id="swallowtailCutDepthId" value="1.0" />
        <br/>

        <label for="swallowtailPointVerticals">swallowtail point vertical ratio csv</label>
        <input type="text" name="swallowtailPointVerticals" id="swallowtailPointVerticalsId" value="1.0" />
        <br/>

        <label for="tailControl">swallow tail stripe control (c = center, i = inside, o = outside, t = top, b = bottom)</label>
        <input type="text" name="tailControl" id="tailControlId" value="o"/>
        <br/>
    </fieldset>

    <fieldset>
        <legend>Background Stripes</legend>
        <label for="stripeOrient">stripe orientation</label>
        <select name="stripeOrient" id="stripeOrientId">
            <option value="horiz selected">horizontal</choice>
            <option value="vert">vertical</choice>
            <option value="diag" >diagonal</choice>
        </select>
        <br/>

        <label for="stripeColorCsv">color csv</label>
        <input type="text" name="stripeColorCsv" id="stripeColorCsvId" value="red,blue,green,yellow" />
        <br/>

        <label for="stripeWidthCsv">width ratio csv</label>
        <input type="text" name="stripeWidthCsv" id="stripeWidthCsvId" value="0.25,0.5,0.75,1.0" />
        <br/>
    </fieldset>

    <fieldset>
        <legend>Canton</legend>
        <label for="cantonMode">canton</label>
        <select name="cantonMode" id="cantonModeId">
            <option value="none" selected>none</choice>
            <option value="rectangle">rectangle</choice>
            <option value="square">square</choice>
            <option value="bar">bar</choice>
            <option value="equi triangle">equi triangle</choice>
            <option value="iso triangle">iso triangle</choice>
        </select>
        <label for="cantonColor">color</label>
        <input type="text" name="cantonColor" id="cantonColorId" value="black" />
        <br/>
    </fieldset>


    <button type="button" onclick="updateFlag();">redraw</button>
</form>
</body>
</html>
